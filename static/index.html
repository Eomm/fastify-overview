<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Fastify Overview</title>
    <meta name="robots" content="noindex" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      body {
        margin: 0;
        overflow: hidden;
      }
      #main {
        height: 100vh;
      }
    </style>
  </head>
  <body>
    <div id="main"></div>
    <script>
      const importer = {
        url: (url) => {
          return new Promise((resolve, reject) => {
            const script = document.createElement("script");
            script.type = "text/javascript";
            script.src = url;
            script.crossOrigin = "anonymous";
            script.addEventListener("load", () => resolve(script), false);
            script.addEventListener("error", (err) => reject(err), false);
            document.body.appendChild(script);
          });
        },
        urls: (urls) => {
          return Promise.all(urls.map(importer.url));
        },
      };

      function render() {
        const host = window.location.host;

        const url = `${window.location.protocol}//${host}`;

        ReactDOM.render(
          React.createElement(FastifyOverviewUI),
          document.getElementById("main")
        );
      }

      function importDependencies() {
        const link = document.createElement("link");
        link.href = "https://unpkg.com/fastify-overview-ui@0.2.0/src/index.css";
        link.type = "text/css";
        link.rel = "stylesheet";
        link.media = "screen,print";
        link.crossOrigin = "anonymous";
        document.getElementsByTagName("head")[0].appendChild(link);

        return importer.urls([
          "https://unpkg.com/react@16.8.0/umd/react.production.min.js",
          "https://unpkg.com/fastify-overview-ui@0.2.0/dist/fastify-overview-ui.umd.js",
          "https://unpkg.com/react-dom@16.8.0/umd/react-dom.production.min.js",
        ]);
      }

      importDependencies().then(render);
    </script>
  </body>
</html>
